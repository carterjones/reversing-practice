# notes

```text
export ExploitEducation=AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABBBB
gdb ./stack-two
break *0x00400709
run
x/200bx $rbp-0x50
i r eax
x/1gx $eax
```

```text
     undefined         AL:1           <RETURN>
     undefined8        Stack[-0x10]:8 &env_var_value_src
     undefined4        Stack[-0x18]:4 target
     undefined1        Stack[-0x50]:1 env_var_value_dst_offset
     undefined1        Stack[-0x58]:1 &env_var_value_dst
     undefined4        Stack[-0x5c]:4 edi_backup
     undefined8        Stack[-0x68]:8 rsi_backup
                     main
004006ad 55                      PUSH       RBP
004006ae 48 89 e5                MOV        RBP,RSP
004006b1 48 83 ec 60             SUB        RSP,0x60
004006b5 89 7d ac                MOV        dword ptr [RBP + edi_backup],EDI
004006b8 48 89 75 a0             MOV        qword ptr [RBP + rsi_backup],RSI
004006bc bf 90 07 40 00          MOV        EDI=>msg_welcome,msg_welcome                                = "Welcome to phoenix/stack-two,
004006c1 e8 3a fe ff ff          CALL       <EXTERNAL>::puts                                            int puts(char * __s)
004006c6 bf da 07 40 00          MOV        EDI=>env_var_name,env_var_name                              = "ExploitEducation"
004006cb e8 20 fe ff ff          CALL       <EXTERNAL>::getenv                                          rax = &(ExploitEducation value)
004006d0 48 89 45 f8             MOV        qword ptr [RBP + &env_var_value_src],RAX
004006d4 48 83 7d f8 00          CMP        qword ptr [RBP + &env_var_value_src],0x0                    check if ExploitEducation is set
004006d9 75 14                   JNZ        env_var_is_set
                     env_var_not_set
004006db be f0 07 40 00          MOV        ESI=>msg_not_set,msg_not_set
004006e0 bf 01 00 00 00          MOV        EDI,0x1
004006e5 b8 00 00 00 00          MOV        EAX,0x0
004006ea e8 21 fe ff ff          CALL       <EXTERNAL>::errx
                     env_var_is_set
004006ef c7 45 f0 00 00 00 00    MOV        dword ptr [RBP + target],0x0                                *target = 0
004006f6 48 8b 55 f8             MOV        RDX,qword ptr [RBP + &env_var_value_src]                    rdx = &env_var_value_src
004006fa 48 8d 45 b0             LEA        RAX=>&env_var_value_dst,[RBP + -0x50]                       rax = rbp-0x50
                                                                                                         so &env_var_value_dst = rbp-0x50
004006fe 48 89 d6                MOV        RSI,RDX                                                     src = &env_var_value_src
00400701 48 89 c7                MOV        RDI,RAX                                                     dst = &env_var_value_dst
00400704 e8 c7 fd ff ff          CALL       <EXTERNAL>::strcpy                                          char * strcpy(char * __dest, cha
00400709 8b 45 f0                MOV        EAX,dword ptr [RBP + target]                                eax = *target
                                                                                                        &target = rsp-0x18
                                                                                                        &dst    = rsp-0x58
                                                                                                        dst-target = 0x40 = 64
0040070c 3d 0a 09 0a 0d          CMP        EAX,0xd0a090a
00400711 75 0c                   JNZ        almost
                     success
00400713 bf 28 08 40 00          MOV        EDI=>msg_success,msg_success                                = "Well done, you have successfu
00400718 e8 e3 fd ff ff          CALL       <EXTERNAL>::puts                                            int puts(char * __s)
0040071d eb 14                   JMP        done
                     almost
0040071f 8b 45 f0                MOV        EAX,dword ptr [RBP + target]
00400722 89 c6                   MOV        ESI,EAX
00400724 bf 70 08 40 00          MOV        EDI=>almost_msg,almost_msg                                  = "Almost! changeme is currently
00400729 b8 00 00 00 00          MOV        EAX,0x0
0040072e e8 ad fd ff ff          CALL       <EXTERNAL>::printf                                          int printf(char * __format, ...)
                     done
00400733 bf 00 00 00 00          MOV        EDI,0x0
00400738 e8 e3 fd ff ff          CALL       <EXTERNAL>::exit                                            void exit(int __status)
```
