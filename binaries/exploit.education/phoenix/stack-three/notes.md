# notes

0x0040069d is the address of the complete_level function. Pipe it in backwards
after the buffer overflow so that it fills the target value, which is then
called in the CALL RDX function at 00400719.

```text
                             complete_level
        0040069d 55                      PUSH       RBP
        0040069e 48 89 e5                MOV        RBP,RSP
        004006a1 bf 90 07 40 00          MOV        EDI=>msg_success,msg_success                                = "Congratulations, you've finis
        004006a6 e8 45 fe ff ff          CALL       <EXTERNAL>::puts                                            int puts(char * __s)
        004006ab bf 00 00 00 00          MOV        EDI,0x0
        004006b0 e8 5b fe ff ff          CALL       <EXTERNAL>::exit                                            void exit(int __status)
```

```text
             undefined8        Stack[-0x18]:8 target
             undefined1        Stack[-0x58]:1 user_input_dst
             undefined4        Stack[-0x5c]:4 edi_backup
             undefined8        Stack[-0x68]:8 rsi_backup
                             main
        004006b5 55                      PUSH       RBP
        004006b6 48 89 e5                MOV        RBP,RSP
        004006b9 48 83 ec 60             SUB        RSP,0x60
        004006bd 89 7d ac                MOV        dword ptr [RBP + edi_backup],EDI
        004006c0 48 89 75 a0             MOV        qword ptr [RBP + rsi_backup],RSI
        004006c4 bf d8 07 40 00          MOV        EDI=>msg_welcome,msg_welcome                                = "Welcome to phoenix/stack-thre
        004006c9 e8 22 fe ff ff          CALL       <EXTERNAL>::puts                                            int puts(char * __s)
        004006ce 48 c7 45 f0 00 00       MOV        qword ptr [RBP + target],0x0
                 00 00
        004006d6 48 8d 45 b0             LEA        RAX=>user_input_dst,[RBP + -0x50]
        004006da 48 89 c7                MOV        RDI,RAX
        004006dd e8 fe fd ff ff          CALL       <EXTERNAL>::gets                                            char * gets(char * __s)
        004006e2 48 8b 45 f0             MOV        RAX,qword ptr [RBP + target]
        004006e6 48 85 c0                TEST       RAX,RAX
        004006e9 74 32                   JZ         fail
                             about_to_call_ptr
        004006eb 48 8b 45 f0             MOV        RAX,qword ptr [RBP + target]
        004006ef 48 89 c6                MOV        RSI,RAX
        004006f2 bf 28 08 40 00          MOV        EDI=>msg_calling_ptr,msg_calling_ptr                        = "calling function pointer @ %p
        004006f7 b8 00 00 00 00          MOV        EAX,0x0
        004006fc e8 cf fd ff ff          CALL       <EXTERNAL>::printf                                          int printf(char * __format, ...)
        00400701 48 8b 05 18 04 20 00    MOV        RAX,qword ptr [stdout]
        00400708 48 89 c7                MOV        RDI,RAX
        0040070b e8 f0 fd ff ff          CALL       <EXTERNAL>::fflush                                          int fflush(FILE * __stream)
        00400710 48 8b 55 f0             MOV        RDX,qword ptr [RBP + target]
        00400714 b8 00 00 00 00          MOV        EAX,0x0
        00400719 ff d2                   CALL       RDX
        0040071b eb 0a                   JMP        done
                             fail
        0040071d bf 48 08 40 00          MOV        EDI=>msg_unmodified_ptr,msg_unmodified_ptr                  = "function pointer remains unmo
        00400722 e8 c9 fd ff ff          CALL       <EXTERNAL>::puts                                            int puts(char * __s)
                             done
        00400727 bf 00 00 00 00          MOV        EDI,0x0
        0040072c e8 df fd ff ff          CALL       <EXTERNAL>::exit                                            void exit(int __status)
                             -- Flow Override: CALL_RETURN (CALL_TERMINATOR)
        00400731 66 2e 0f 1f 84 00       NOP        word ptr CS:[RAX + RAX*0x1]
                 00 00 00 00
        0040073b 0f 1f 44 00 00          NOP        dword ptr [RAX + RAX*0x1]
```
